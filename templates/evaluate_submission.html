{% extends "base.html" %}
{% set s = submission %}
{% block title %}Evaluate – {{ s.student.name }}{% endblock %}
{% block content %}
<h1 class="page-title">Evaluate submission</h1>
<p style="color: var(--text-muted); margin-bottom: 1rem;">
  <a href="{{ url_for('list_submissions', aid=s.assignment_id) }}" class="file-link">← Back to submissions</a>
</p>
<div class="card" style="margin-bottom: 1.5rem;">
  <h3>Assignment: {{ s.assignment.title }}</h3>
  <p><strong>Student:</strong> {{ s.student.name }} ({{ s.student.email }})</p>
  <p><strong>Submitted:</strong> {{ s.submitted_at.strftime('%b %d, %Y %H:%M') }}</p>
  {% if s.content %}
  <div style="margin-top: 1rem;">
    <strong>Text response:</strong>
    <pre style="background: var(--bg); padding: 1rem; border-radius: 8px; overflow-x: auto; white-space: pre-wrap;">{{ s.content }}</pre>
  </div>
  {% endif %}
  {% if s.file_path %}
  <p style="margin-top: 0.5rem;"><strong>Attached file:</strong> <a href="{{ url_for('download_submission_file', sid=s.id) }}" class="file-link">Download</a></p>
  {% endif %}
</div>
<div class="card">
  <form method="post" action="{{ url_for('evaluate_submission', sid=s.id) }}">
    <div class="form-group">
      <label for="marks">Marks (out of {{ s.assignment.max_marks }})</label>
      <input type="number" id="marks" name="marks" min="0" max="{{ s.assignment.max_marks }}" step="0.5" value="{{ s.marks if s.marks is not none else '' }}" placeholder="e.g. 85">
    </div>
    <div class="form-group">
      <label for="feedback">Feedback (optional)</label>
      <textarea id="feedback" name="feedback" placeholder="Comments for the student...">{{ s.feedback if s.feedback else '' }}</textarea>
    </div>
    <button type="submit" class="btn btn-success">Save evaluation</button>
    <a href="{{ url_for('list_submissions', aid=s.assignment_id) }}" class="btn btn-ghost">Cancel</a>
  </form>
</div>
{% endblock %}
